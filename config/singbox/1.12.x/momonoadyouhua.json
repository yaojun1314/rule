{
  "log": {
    "level": "info",
    "timestamp": true,
    "output": "/var/log/sing-box.log"
  },
  "dns": {
    "servers": [
      {
        "tag": "local",
        "address": "223.5.5.5",
        "detour": "direct"
      },
      {
        "tag": "doh",
        "address": "https://1.1.1.1/dns-query",
        "detour": "🚀 默认代理"
      },
      {
        "tag": "block",
        "address": "rcode://success"
      }
    ],
    "rules": [
      {
        "outbound": "any",
        "server": "doh"
      },
      {
        "geosite": "cn",
        "server": "local"
      },
      {
        "domain_suffix": ["openai.com", "anthropic.com"],
        "server": "doh",
        "disable_cache": true
      },
      {
        "rule_set": ["geosite-category-ads-all"],
        "server": "block"
      }
    ],
    "final": "doh",
    "strategy": "prefer_ipv4"
  },
  "inbounds": [
    {
      "type": "tun",
      "tag": "tun-in",
      "interface_name": "Momo",
      "mtu": 1500,
      "stack": "system",
      "strict_route": true,
      "sniff": true,
      "sniff_override_destination": true
    }
  ],
  "outbounds": [
    // ==================== 核心代理组 ====================
    {
      "tag": "🚀 默认代理",
      "type": "selector",
      "outbounds": ["♻️ 自动选择", "🇭🇰 香港", "🇺🇸 美国", "🇯🇵 日本", "🇸🇬 新加坡"],
      "default": "♻️ 自动选择",
      "interrupt_exist_connections": false
    },
    {
      "tag": "♻️ 自动选择",
      "type": "urltest",
      "outbounds": ["🇭🇰 香港", "🇺🇸 美国", "🇯🇵 日本"],
      "url": "http://www.gstatic.com/generate_204",
      "interval": "1m",
      "tolerance": 50,
      "interrupt_exist_connections": false
    },

    // ==================== 区域节点组 ====================
    {
      "tag": "🇭🇰 香港",
      "type": "vless",
      "server": "hk.example.com",
      "server_port": 443,
      "uuid": "your-uuid-here",
      "flow": "xtls-rprx-vision",
      "tls": {
        "enabled": true,
        "server_name": "hk.example.com",
        "utls": {
          "enabled": true,
          "fingerprint": "chrome"
        }
      },
      "transport": {
        "type": "ws",
        "path": "/v2ray",
        "headers": {
          "Host": "hk.example.com"
        }
      }
    },
    {
      "tag": "🇺🇸 美国",
      "type": "vless",
      "server": "us.example.com",
      "server_port": 443,
      "uuid": "your-uuid-here",
      "flow": "xtls-rprx-vision",
      "tls": {
        "enabled": true,
        "server_name": "us.example.com",
        "alpn": ["h2", "http/1.1"]
      }
    },
    {
      "tag": "🇯🇵 日本",
      "type": "vless",
      "server": "jp.example.com",
      "server_port": 443,
      "uuid": "your-uuid-here",
      "flow": "xtls-rprx-vision",
      "multiplex": {
        "enabled": true,
        "max_connections": 4
      }
    },

    // ==================== 专项服务组 ====================
    {
      "tag": "🧠 AI",
      "type": "selector",
      "outbounds": ["🇺🇸 美国-OpenAI", "🇸🇬 新加坡-Claude"],
      "default": "🇺🇸 美国-OpenAI"
    },
    {
      "tag": "🇺🇸 美国-OpenAI",
      "type": "vless",
      "server": "openai.example.com",
      "server_port": 443,
      "uuid": "your-uuid-here",
      "tls": {
        "enabled": true,
        "server_name": "api.openai.com",
        "reality": {
          "enabled": true,
          "public_key": "your-pk-here",
          "short_id": "your-id"
        }
      }
    },
    {
      "tag": "📹 YouTube",
      "type": "selector",
      "outbounds": ["🇺🇸 美国", "🇯🇵 日本"],
      "strategy": "max_bandwidth"
    },
    {
      "tag": "🎬 Emby",
      "type": "selector",
      "outbounds": ["🇭🇰 香港", "🇸🇬 新加坡"],
      "strategy": "min_delay"
    },
    {
      "tag": "🍀 Google",
      "type": "selector",
      "outbounds": ["🇺🇸 美国", "🇯🇵 日本"],
      "multiplex": {
        "enabled": true,
        "max_streams": 8
      }
    },
    {
      "tag": "👨‍💻 Github",
      "type": "selector",
      "outbounds": ["🇺🇸 美国", "🇸🇬 新加坡"],
      "strategy": "min_loss"
    },
    {
      "tag": "📲 Telegram",
      "type": "selector",
      "outbounds": ["🇭🇰 香港", "🇷🇺 俄罗斯"],
      "tcp_fast_open": true
    },
    {
      "tag": "🎵 TikTok",
      "type": "selector",
      "outbounds": ["🇯🇵 日本", "🇰🇷 韩国"],
      "override": {
        "tls": {
          "server_name": "www.tiktok.com"
        }
      }
    },
    {
      "tag": "🎥 Netflix",
      "type": "selector",
      "outbounds": ["🇺🇸 美国", "🇯🇵 日本"],
      "override": {
        "tls": {
          "server_name": "www.netflix.com",
          "alpn": ["h2"]
        }
      }
    },
    {
      "tag": "🎮 Steam",
      "type": "selector",
      "outbounds": ["🇭🇰 香港", "🇸🇬 新加坡"],
      "multiplex": {
        "enabled": true,
        "max_connections": 4,
        "min_streams": 2
      }
    },
    {
      "tag": "🪟 Microsoft",
      "type": "selector",
      "outbounds": ["🇺🇸 美国", "🇪🇺 欧洲"],
      "detour": "direct"
    },
    {
      "tag": "🍏 Apple",
      "type": "selector",
      "outbounds": ["🇺🇸 美国", "🇯🇵 日本"],
      "tcp_fast_open": true
    },

    // ==================== 系统组 ====================
    {
      "tag": "🎯 全球直连",
      "type": "direct"
    },
    {
      "tag": "🐠 漏网之鱼",
      "type": "selector",
      "outbounds": ["🚀 默认代理", "🎯 全球直连"],
      "default": "🚀 默认代理"
    },
    {
      "tag": "dns-out",
      "type": "dns"
    }
  ],

  "route": {
    "rules": [
      // ======== 基础规则 ========
      {"protocol": "dns", "outbound": "dns-out"},
      {"ip_is_private": true, "outbound": "🎯 全球直连"},
      {"geoip": ["private", "cn"], "outbound": "🎯 全球直连"},
      {"geosite": "cn", "outbound": "🎯 全球直连"},

      // ======== 广告拦截 ========
      {
        "rule_set": ["geosite-category-ads-all"],
        "outbound": "block"
      },
      {
        "domain_keyword": ["tracking", "analytics"],
        "outbound": "block"
      },

      // ======== 分组路由规则 ========
      {"domain_suffix": ["openai.com", "anthropic.com"], "outbound": "🧠 AI"},
      {"domain_keyword": ["youtube.com", "youtu.be"], "outbound": "📹 YouTube"},
      {"domain_suffix": ["emby.media", "jellyfin.org"], "outbound": "🎬 Emby"},
      {"domain_suffix": ["google.com", "googleapis.com"], "outbound": "🍀 Google"},
      {"domain_suffix": ["github.com", "github.io"], "outbound": "👨‍💻 Github"},
      {"domain_suffix": ["telegram.org", "t.me"], "outbound": "📲 Telegram"},
      {"domain_suffix": ["tiktokv.com", "musical.ly"], "outbound": "🎵 TikTok"},
      {"domain_suffix": ["netflix.com", "nflxso.net"], "outbound": "🎥 Netflix"},
      {"domain_suffix": ["steampowered.com", "steamcontent.com"], "outbound": "🎮 Steam"},
      {"domain_suffix": ["microsoft.com", "windowsupdate.com"], "outbound": "🪟 Microsoft"},
      {"domain_suffix": ["apple.com", "icloud.com"], "outbound": "🍏 Apple"},

      // ======== 增强规则 ========
      {
        "rule_set": ["geosite-category-streaming"],
        "outbound": "📹 YouTube",
        "strategy": "max_bandwidth"
      },
      {
        "rule_set": ["geosite-game"],
        "outbound": "🎮 Steam",
        "strategy": "min_delay"
      },
      {
        "rule_set": ["geosite-microsoft"],
        "outbound": "🪟 Microsoft"
      }
    ],
    "rule_set": [
      {
        "tag": "geosite-category-ads-all",
        "type": "remote",
        "format": "binary",
        "url": "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geo/geosite/category-ads-all.srs",
        "download_detour": "🚀 默认代理"
      },
      {
        "tag": "geosite-game",
        "type": "remote",
        "format": "binary",
        "url": "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geo/geosite/game.srs"
      }
    ],
    "final": "🐠 漏网之鱼",
    "auto_detect_interface": true
  },

  "experimental": {
    "cache_file": {
      "enabled": true,
      "path": "/etc/sing-box/cache.db",
      "cache_size": 10000
    },
    "clash_api": {
      "external_controller": "127.0.0.1:9090",
      "secret": "your-secret"
    }
  }
}
