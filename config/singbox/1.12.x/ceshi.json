{
  "$schema": "https://schemas.sing-box.com/config.schema.json",
  "dns": {
    "servers": [
      // ==== å¹¿å‘Šæ‹¦æˆªä¸“ç”¨DNS ====
      {
        "tag": "dns_adblock",
        "address": "https://dns.adguard.com/dns-query",
        "detour": "direct",
        "strategy": "ipv4_only",
        "rules": [
          {"rule_set": ["geosite-ads"], "server": "rcode://success"},
          {"domain_suffix": [".ad.", ".track."], "disable_cache": true}
        ]
      },
      // ==== ä½å»¶è¿ŸDNSé›†ç¾¤ ====
      {
        "tag": "dns_fast",
        "address": "quic://dns.cloudflare.com",
        "detour": "âš¡ ä½å»¶è¿Ÿä¼˜é€‰",
        "strategy": "prefer_ipv6",
        "dialer_options": {
          "tcp_fast_open": true,
          "udp_fragment": true
        }
      },
      // ==== å›½å†…DNS ====
      {
        "tag": "dns_cn",
        "address": "https://doh.pub/dns-query",
        "detour": "direct"
      }
    ],
    "rules": [
      // å¼ºåˆ¶æ‹¦æˆªå¹¿å‘Š
      {
        "rule_set": ["geosite-ads"],
        "server": "rcode://success",
        "disable_cache": true
      },
      // æµåª’ä½“åŠ é€Ÿ
      {
        "rule_set": ["geosite-streaming"],
        "server": "dns_fast",
        "strategy": "prefer_ipv6"
      },
      // å›½å†…åŸŸå
      {
        "geosite": ["cn"],
        "server": "dns_cn"
      }
    ],
    "final": "dns_fast",
    "independent_cache": true,
    "cache_strategy": "enforce"
  },

  "outbounds": [
    // ========== åŸå§‹ç­–ç•¥ç»„ï¼ˆå®Œå…¨ä¿ç•™ï¼‰ ==========
    {"tag": "ğŸš€ é»˜è®¤ä»£ç†", "type": "selector", "outbounds": ["ğŸ‡­ğŸ‡° é¦™æ¸¯æ‰‹åŠ¨", "ğŸ‡¯ğŸ‡µ æ—¥æœ¬æ‰‹åŠ¨", "ğŸ‡¸ğŸ‡¬ ç‹®åŸæ‰‹åŠ¨", "ğŸ‡ºğŸ‡² ç¾å›½æ‰‹åŠ¨", "ğŸ¸ æ‰‹åŠ¨é€‰æ‹©", "â™»ï¸ è‡ªåŠ¨é€‰æ‹©"]},
    {"tag": "ğŸ§  AI", "type": "selector", "outbounds": ["ğŸ‡¯ğŸ‡µ æ—¥æœ¬æ‰‹åŠ¨", "ğŸ‡¸ğŸ‡¬ ç‹®åŸæ‰‹åŠ¨", "ğŸ‡ºğŸ‡² ç¾å›½æ‰‹åŠ¨"]},
    {"tag": "ğŸ“¹ YouTube", "type": "selector", "outbounds": ["ğŸ‡­ğŸ‡° é¦™æ¸¯æ‰‹åŠ¨", "ğŸ‡¯ğŸ‡µ æ—¥æœ¬æ‰‹åŠ¨", "ğŸ‡¸ğŸ‡¬ ç‹®åŸæ‰‹åŠ¨", "ğŸ‡ºğŸ‡² ç¾å›½æ‰‹åŠ¨", "ğŸ¸ æ‰‹åŠ¨é€‰æ‹©"]},
    {"tag": "ğŸ¬ Emby", "type": "selector", "outbounds": ["ğŸ‡­ğŸ‡° é¦™æ¸¯æ‰‹åŠ¨"]},
    {"tag": "ğŸ€ Google", "type": "selector", "outbounds": ["ğŸ‡­ğŸ‡° é¦™æ¸¯æ‰‹åŠ¨", "ğŸ‡¯ğŸ‡µ æ—¥æœ¬æ‰‹åŠ¨", "ğŸ‡¸ğŸ‡¬ ç‹®åŸæ‰‹åŠ¨", "ğŸ‡ºğŸ‡² ç¾å›½æ‰‹åŠ¨", "ğŸ¸ æ‰‹åŠ¨é€‰æ‹©"]},
    {"tag": "ğŸ‘¨â€ğŸ’» Github", "type": "selector", "outbounds": ["ğŸ‡¯ğŸ‡µ æ—¥æœ¬æ‰‹åŠ¨", "ğŸ‡­ğŸ‡° é¦™æ¸¯æ‰‹åŠ¨", "ğŸ‡¸ğŸ‡¬ ç‹®åŸæ‰‹åŠ¨", "ğŸ‡ºğŸ‡² ç¾å›½æ‰‹åŠ¨", "ğŸ¸ æ‰‹åŠ¨é€‰æ‹©"]},
    {"tag": "ğŸ“² Telegram", "type": "selector", "outbounds": ["ğŸ‡¸ğŸ‡¬ ç‹®åŸæ‰‹åŠ¨", "ğŸ‡­ğŸ‡° é¦™æ¸¯æ‰‹åŠ¨", "ğŸ‡¯ğŸ‡µ æ—¥æœ¬æ‰‹åŠ¨", "ğŸ‡ºğŸ‡² ç¾å›½æ‰‹åŠ¨", "ğŸ¸ æ‰‹åŠ¨é€‰æ‹©"]},
    {"tag": "ğŸµ TikTok", "type": "selector", "outbounds": ["ğŸ‡¯ğŸ‡µ æ—¥æœ¬æ‰‹åŠ¨", "ğŸ‡¸ğŸ‡¬ ç‹®åŸæ‰‹åŠ¨", "ğŸ‡ºğŸ‡² ç¾å›½æ‰‹åŠ¨", "ğŸ¸ æ‰‹åŠ¨é€‰æ‹©"]},
    {"tag": "ğŸ¥ Netflix", "type": "selector", "outbounds": ["ğŸ‡­ğŸ‡° é¦™æ¸¯æ‰‹åŠ¨", "ğŸ‡¯ğŸ‡µ æ—¥æœ¬æ‰‹åŠ¨", "ğŸ‡¸ğŸ‡¬ ç‹®åŸæ‰‹åŠ¨", "ğŸ‡ºğŸ‡² ç¾å›½æ‰‹åŠ¨", "ğŸ¸ æ‰‹åŠ¨é€‰æ‹©"]},
    {"tag": "ğŸ’¶ PayPal", "type": "selector", "outbounds": ["ğŸ‡­ğŸ‡° é¦™æ¸¯æ‰‹åŠ¨", "ğŸ‡¯ğŸ‡µ æ—¥æœ¬æ‰‹åŠ¨", "ğŸ‡¸ğŸ‡¬ ç‹®åŸæ‰‹åŠ¨", "ğŸ‡ºğŸ‡² ç¾å›½æ‰‹åŠ¨", "ğŸ¸ æ‰‹åŠ¨é€‰æ‹©"]},
    {"tag": "ğŸ® Steam", "type": "selector", "outbounds": ["ğŸ‡­ğŸ‡° é¦™æ¸¯æ‰‹åŠ¨", "ğŸ‡¯ğŸ‡µ æ—¥æœ¬æ‰‹åŠ¨", "ğŸ‡¸ğŸ‡¬ ç‹®åŸæ‰‹åŠ¨", "ğŸ‡ºğŸ‡² ç¾å›½æ‰‹åŠ¨", "ğŸ¸ æ‰‹åŠ¨é€‰æ‹©"]},
    {"tag": "ğŸªŸ Microsoft", "type": "selector", "outbounds": ["ğŸ‡¯ğŸ‡µ æ—¥æœ¬æ‰‹åŠ¨", "ğŸ‡¸ğŸ‡¬ ç‹®åŸæ‰‹åŠ¨", "ğŸ‡ºğŸ‡² ç¾å›½æ‰‹åŠ¨", "ğŸ¸ æ‰‹åŠ¨é€‰æ‹©"]},
    {"tag": "ğŸ¬ OneDrive", "type": "selector", "outbounds": ["ğŸ‡¯ğŸ‡µ æ—¥æœ¬æ‰‹åŠ¨", "ğŸ‡¸ğŸ‡¬ ç‹®åŸæ‰‹åŠ¨", "ğŸ‡ºğŸ‡² ç¾å›½æ‰‹åŠ¨", "ğŸ¸ æ‰‹åŠ¨é€‰æ‹©"]},
    {"tag": "ğŸ Apple", "type": "selector", "outbounds": ["ğŸ¯ å…¨çƒç›´è¿", "ğŸ‡­ğŸ‡° é¦™æ¸¯æ‰‹åŠ¨", "ğŸ‡¯ğŸ‡µ æ—¥æœ¬æ‰‹åŠ¨", "ğŸ‡¸ğŸ‡¬ ç‹®åŸæ‰‹åŠ¨", "ğŸ‡ºğŸ‡² ç¾å›½æ‰‹åŠ¨"]},
    {"tag": "ğŸ  æ¼ç½‘ä¹‹é±¼", "type": "selector", "outbounds": ["ğŸš€ é»˜è®¤ä»£ç†", "ğŸ¯ å…¨çƒç›´è¿"]},
    {"tag": "ğŸ‡­ğŸ‡° é¦™æ¸¯æ‰‹åŠ¨", "type": "selector", "outbounds": ["{all}"], "filter": [{"action": "include", "keywords": ["ğŸ‡­ğŸ‡°|HK|hk|é¦™æ¸¯|æ¸¯|HongKong"]}, {"action": "exclude", "keywords": ["å…è´¹"]}]},
    {"tag": "ğŸ‡¯ğŸ‡µ æ—¥æœ¬æ‰‹åŠ¨", "type": "selector", "outbounds": ["{all}"], "filter": [{"action": "include", "keywords": ["ğŸ‡¯ğŸ‡µ|JP|jp|æ—¥æœ¬|æ—¥|Japan"]}, {"action": "exclude", "keywords": ["å…è´¹"]}]},
    {"tag": "ğŸ‡¸ğŸ‡¬ ç‹®åŸæ‰‹åŠ¨", "type": "selector", "outbounds": ["{all}"], "filter": [{"action": "include", "keywords": ["æ–°åŠ å¡|å¡|ç‹®åŸ|SG|Singapore"]}, {"action": "exclude", "keywords": ["å…è´¹"]}]},
    {"tag": "ğŸ‡ºğŸ‡² ç¾å›½æ‰‹åŠ¨", "type": "selector", "outbounds": ["{all}"], "filter": [{"action": "include", "keywords": ["ğŸ‡ºğŸ‡¸|US|us|ç¾å›½|ç¾|United States"]}, {"action": "exclude", "keywords": ["AUS|RUS|å…è´¹"]}]},
    {"tag": "ğŸ¸ æ‰‹åŠ¨é€‰æ‹©", "type": "selector", "outbounds": ["{all}"], "filter": [{"action": "exclude", "keywords": ["ç½‘ç«™|æµé‡|åœ°å€|å‰©ä½™|è¿‡æœŸ|å…è´¹|æ—¶é—´|æœ‰æ•ˆ|Traffic|ExpireDate|GB|Expire Date"]}]},
    {"tag": "â™»ï¸ è‡ªåŠ¨é€‰æ‹©", "type": "urltest", "outbounds": ["{all}"], "filter": [{"action": "exclude", "keywords": ["å®˜ç½‘|åˆ°æœŸæ—¶é—´|å‰©ä½™|æµé‡|å¥—é¤|å…è´¹|è®¢é˜…|å…¨çƒç›´è¿|GB|Expire Date|Traffic|ExpireDate"]}], "interval": "10m", "tolerance": 100},
    {"tag": "ğŸƒ å»¶è¿Ÿè¾…åŠ©", "type": "urltest", "outbounds": ["ğŸš€ é»˜è®¤ä»£ç†", "ğŸ¯ å…¨çƒç›´è¿"]},
    {"tag": "GLOBAL", "type": "selector", "outbounds": ["ğŸš€ é»˜è®¤ä»£ç†", "ğŸ§  AI", "ğŸ“¹ YouTube", "ğŸ¬ Emby", "ğŸ€ Google", "ğŸ‘¨â€ğŸ’» Github", "ğŸ“² Telegram", "ğŸµ TikTok", "ğŸ¥ Netflix", "ğŸ’¶ PayPal", "ğŸ® Steam", "ğŸªŸ Microsoft", "ğŸ¬ OneDrive", "ğŸ Apple", "ğŸ  æ¼ç½‘ä¹‹é±¼", "ğŸ‡­ğŸ‡° é¦™æ¸¯æ‰‹åŠ¨", "ğŸ‡¯ğŸ‡µ æ—¥æœ¬æ‰‹åŠ¨", "ğŸ‡¸ğŸ‡¬ ç‹®åŸæ‰‹åŠ¨", "ğŸ‡ºğŸ‡² ç¾å›½æ‰‹åŠ¨", "ğŸ¸ æ‰‹åŠ¨é€‰æ‹©", "â™»ï¸ è‡ªåŠ¨é€‰æ‹©", "ğŸƒ å»¶è¿Ÿè¾…åŠ©", "ğŸ¯ å…¨çƒç›´è¿"]},
    {"tag": "ğŸ¯ å…¨çƒç›´è¿", "type": "direct"},
    {"tag": "block", "type": "block"}
  ],
  "route": {
    "rules": [
      {"action": "sniff", "sniffer": ["http", "tls", "quic", "dns"]},
      {"inbound": "dns-in", "action": "hijack-dns"},
      {"ip_is_private": true, "outbound": "ğŸ¯ å…¨çƒç›´è¿"},
      {"clash_mode": "direct", "outbound": "ğŸ¯ å…¨çƒç›´è¿"},
      {"clash_mode": "global", "outbound": "GLOBAL"},
      {"rule_set": "geosite-category-ads-all", "outbound": "block"},
      {"domain_suffix": [
        "doubleclick.net", "googlesyndication.com", "googletagmanager.com", 
        "googletagservices.com", "google-analytics.com", "googleadservices.com",
        "facebook.com", "fbcdn.net", "fb.com", "fbsbx.com",
        "cdninstagram.com", "instagram.com",
        "twitter.com", "twimg.com",
        "tiktok.com", "tiktokcdn.com", "tiktokv.com", "byteoversea.com", "bytedance.com",
        "amplitude.com", "optimizely.com", "krxd.net", "scorecardresearch.com", "quantserve.com"
      ], "outbound": "block"},
      {"domain_keyword": [
        "ads", "ad", "tracking", "analytics", "pixel", "beacon", 
        "doubleclick", "googlesyndication", "googletagmanager", "googletagservices", "google-analytics"
      ], "outbound": "block"},
      {"ip_cidr": [
        "172.217.0.0/16", "172.217.160.0/20", "172.217.160.1/32",
        "172.217.160.2/31", "172.217.160.4/30", "172.217.160.8/29",
        "172.217.160.16/28", "172.217.160.32/27", "172.217.160.64/26",
        "172.217.160.128/25", "172.217.161.0/24", "172.217.162.0/23",
        "172.217.164.0/22", "172.217.168.0/21", "172.217.176.0/20",
        "172.217.192.0/18"
      ], "outbound": "block"},
      {"rule_set": "geosite-youtube", "outbound": "ğŸ“¹ YouTube"},
      {"rule_set": "geosite-emby", "outbound": "ğŸ¬ Emby"},
      {"domain_suffix": [
        "emby.media", "embyaccess.com", "jellyfin.org", 
        "jellyfin.media", "jellyfin.tv", "jellyfin.dev", 
        "jellyfin.exp", "jellyfin.net", "emby.tv", "emby.app",
        "emby.server", "emby.client", "emby.sync", "emby.connect",
        "emby.theater", "emby.player", "emby.mobile", "emby.android",
        "emby.ios", "emby.windows", "emby.linux", "emby.macos",
        "emby.web", "emby.dashboard", "emby.api", "emby.rest"
      ], "outbound": "ğŸ¬ Emby"},
      {"rule_set": "geosite-ai", "outbound": "ğŸ§  AI"},
      {"rule_set": "geosite-google", "outbound": "ğŸ€ Google"},
      {"rule_set": "geosite-github", "outbound": "ğŸ‘¨â€ğŸ’» Github"},
      {"rule_set": "geosite-onedrive", "outbound": "ğŸ¬ OneDrive"},
      {"rule_set": "geosite-microsoft", "outbound": "ğŸªŸ Microsoft"},
      {"rule_set": "geosite-apple", "outbound": "ğŸ Apple"},
      {"rule_set": "geosite-telegram", "outbound": "ğŸ“² Telegram"},
      {"rule_set": "geosite-tiktok", "outbound": "ğŸµ TikTok"},
      {"rule_set": "geosite-netflix", "outbound": "ğŸ¥ Netflix"},
      {"rule_set": "geosite-paypal", "outbound": "ğŸ’¶ PayPal"},
      {"rule_set": "geosite-steamcn", "outbound": "ğŸ¯ å…¨çƒç›´è¿"},
      {"rule_set": "geosite-steam", "outbound": "ğŸ® Steam"},
      {"rule_set": "geosite-!cn", "outbound": "ğŸš€ é»˜è®¤ä»£ç†"},
      {"rule_set": "geosite-cn", "outbound": "ğŸ¯ å…¨çƒç›´è¿"},
      {"rule_set": "geoip-google", "outbound": "ğŸ€ Google"},
      {"rule_set": "geoip-apple", "outbound": "ğŸ Apple"},
      {"rule_set": "geoip-telegram", "outbound": "ğŸ“² Telegram"},
      {"rule_set": "geoip-netflix", "outbound": "ğŸ¥ Netflix"},
      {"rule_set": "geoip-cn", "outbound": "ğŸ¯ å…¨çƒç›´è¿"}
    ],

    // ========== æ–°å¢ä¼˜åŒ–ç»„ ==========
    // 1. ä½å»¶è¿Ÿä¼˜é€‰ç»„
    {
      "tag": "âš¡ ä½å»¶è¿Ÿä¼˜é€‰",
      "type": "urltest",
      "outbounds": ["ğŸ‡­ğŸ‡° é¦™æ¸¯æ‰‹åŠ¨", "ğŸ‡¯ğŸ‡µ æ—¥æœ¬æ‰‹åŠ¨", "ğŸ‡¸ğŸ‡¬ ç‹®åŸæ‰‹åŠ¨"],
      "interval": "3m",
      "tolerance": 50,
      "dialer_options": {
        "tcp_keep_alive": 10,
        "tcp_no_delay": true,
        "tcp_fast_open": true
      },
      "transport": {
        "type": "ws",
        "path": "/lowlatency",
        "headers": {
          "X-Edge-Type": "CDN"
        }
      }
    },
    // 2. å¹¿å‘Šæ‹¦æˆªå‡ºå£
    {
      "tag": "ğŸ›‘ å¹¿å‘Šæ‹¦æˆª",
      "type": "block",
      "override": {
        "response": {
          "status_code": 444,
          "body": "Blocked by Momo-AdFilter"
        }
      }
    }
  ],

  "route": {
    "rules": [
      // ====== å¹¿å‘Šæ‹¦æˆªè§„åˆ™ ======
      {
        "rule_set": ["geosite-ads", "geoip-ads"],
        "outbound": "ğŸ›‘ å¹¿å‘Šæ‹¦æˆª",
        "disable_cache": true
      },
      {
        "protocol": ["quic", "http/2"],
        "domain_keyword": ["adservice", "tracking"],
        "outbound": "ğŸ›‘ å¹¿å‘Šæ‹¦æˆª"
      },

      // ====== ä½å»¶è¿Ÿè·¯ç”± ======
      {
        "rule_set": ["geosite-streaming"],
        "outbound": "âš¡ ä½å»¶è¿Ÿä¼˜é€‰",
        "speed_limit": "20mbps",
        "qos": {
          "priority": 1,
          "dscp": "AF41"
        }
      },
      {
        "rule_set": ["geosite-gaming"],
        "outbound": "âš¡ ä½å»¶è¿Ÿä¼˜é€‰",
        "qos": {
          "priority": 0,
          "dscp": "CS6"
        }
      },

      // ====== ä¿ç•™åŸå§‹è§„åˆ™ ======
      {"geoip": ["cn"], "outbound": "ğŸ¯ å…¨çƒç›´è¿"},
      {"geosite": ["cn"], "outbound": "ğŸ¯ å…¨çƒç›´è¿"},
      {"domain_suffix": ["msftconnecttest.com"], "outbound": "direct"}
    ],

    "rule_set": [
      // ====== å¹¿å‘Šè§„åˆ™é›† ======
      {
        "tag": "geosite-ads",
        "type": "remote",
        "format": "binary",
        "url": "https://fastly.jsdelivr.net/gh/PrivaterVPN/anti-ads@master/singbox-rules/geosite-ads.srs",
        "update_interval": "6h",
        "download_detour": "direct"
      },
      {
        "tag": "geoip-ads",
        "type": "remote",
        "format": "binary",
        "url": "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geo/geoip/ads.srs",
        "update_interval": "12h"
      },

      // ====== ä½å»¶è¿Ÿè§„åˆ™é›† ======
      {
        "tag": "geosite-streaming",
        "type": "remote",
        "format": "binary",
        "url": "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geo/geosite/streaming.srs",
        "update_interval": "24h"
      },
      {
        "tag": "geosite-gaming",
        "type": "remote",
        "format": "binary",
        "url": "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geo/geosite/gaming.srs",
        "update_interval": "24h"
      }
    ],
    "final": "ğŸ  æ¼ç½‘ä¹‹é±¼",
    "auto_detect_interface": true
  },

  "experimental": {
    "cache_file": {
      "enabled": true,
      "path": "/etc/momo/cache_v4.db",
      "cache_id": "v4_${DATE}"
    },
    "clash_api": {
      "external_controller": "0.0.0.0:9090",
      "external_ui": "builtin",
      "update_interval": "24h"
    },
    "v2ray_api": {
      "listen": "127.0.0.1:10085",
      "stats": {
        "inbounds": ["all"],
        "outbounds": ["âš¡ ä½å»¶è¿Ÿä¼˜é€‰"]
      }
    }
  },

  "ntp": {
    "enabled": true,
    "server": "time.windows.com",
    "server_port": 123,
    "interval": "1h",
    "detour": "direct"
  },

  "log": {
    "level": "info",
    "output": "/var/log/momo/singbox.log",
    "timestamp": true,
    "stacktrace": false
  }
}
